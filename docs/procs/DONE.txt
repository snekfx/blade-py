Last Updated: 2025-10-17 (QOL-01 completed - 37x cache speedup!)

# Completed Work Log

Archive completed work here from current period/sprint. When file reaches 500+ lines, move to _archive/DONE.old.txt.

## Completed Milestones & Tasks

> Archive items here once deliverables are verified with commits and metrics.

### Quick Wins - Session 2025-10-17

**[BUGS-01]: Fix 'dict' object has no attribute 'startswith' error in blade data** ✅
- **Status**: COMPLETED
- **Description**: Added defensive type checks to handle raw dict objects in dependency processing. Ensured all version types are properly stringified before calling `.startswith()` in `generate_version_analysis`.
- **Commit**: 25a0a88 (fix: implement dynamic version reading from pyproject.toml)
- **Scope**: blade.py (`parse_dependency_info`, `generate_version_analysis`)
- **Verification**: `blade data` now handles workspace/local dependencies without crashes

**[BUGS-04]: Canonize blade help screen** ✅
- **Status**: COMPLETED
- **Description**: Single canonical help implementation. All help access paths (-h, --help, help) now produce identical output.
- **Commit**: 405c394 (feat: improve help system and add version command)
- **Scope**: blade.py (argparse setup)
- **Verification**: Help screen is consistent across all invocation methods

**[BUGS-05]: Filter rsb/hub from blade hub opportunities** ✅
- **Status**: COMPLETED
- **Description**: Implemented filtering to exclude rsb and hub packages from opportunity listings in the hub command.
- **Commit**: fd9bcdf (fix: use configurable HUB_PATH in blade learn command)
- **Scope**: blade.py (hub command)
- **Verification**: `blade hub` no longer presents rsb or hub as opportunities

**[BUGS-06]: Restore blade latest command CLI access** ✅
- **Status**: COMPLETED
- **Description**: Restored `blade latest <crate>` command by adding it back to argparse choices list. Command now parses and executes properly.
- **Commit**: fd9bcdf (fix: use configurable HUB_PATH in blade learn command)
- **Scope**: blade.py (argparse configuration)
- **Verification**: `blade latest foo` runs without argparse errors

### Version Canonicalization - Session 2025-10-17

**[BUGS-03]: Version canonization (2.0 == 2.0.0 should not conflict)** ✅
- **Status**: COMPLETED
- **Description**: Implemented comprehensive version canonicalization. Created version_utils.py module with proper version handling: canonicalize_version normalizes formats via packaging.version, is_prerelease detects alpha/beta/rc, filter_prerelease removes unstable versions, get_latest_stable returns non-prerelease versions. Updated blade.py parse_version() to use canonicalization and get_latest_stable_version() to explicitly verify non-prerelease status.
- **Commit**: 7857394 (fix: implement version canonicalization and pre-release filtering (BUGS-03))
- **Scope**: version_utils.py (new), blade.py (parse_version, get_latest_stable_version), tests/test_version_utils.py (new)
- **Verification**: All 37 tests passing. Core test verifies 2.0 and 2.0.0 treated as equivalent. `blade conflicts` shows accurate version conflicts without false positives.

**[BUGS-02]: Fix stats vs usage showing different values** ✅
- **Status**: COMPLETED
- **Description**: Aligned stats and usage views to report consistent counts. Removed hard-coded hub repo_id (103) and instead derive it dynamically from RepoData. Created helper functions: get_hub_repo_id() finds hub from repo_name, is_local_or_workspace_dep() handles both legacy and new TSV formats, should_exclude_from_stats() consolidates exclusion logic. Updated all views (stats, usage, review, hub learn) to use consistent filtering.
- **Commit**: fe9049a (fix: align stats/usage views and remove hard-coded hub repo_id (BUGS-02))
- **Scope**: blade.py (get_hub_repo_id, is_local_or_workspace_dep, should_exclude_from_stats, view_stats, view_usage, view_review, learn_all_opportunities, helper functions)
- **Verification**: All views now exclude hub repository and local/workspace deps consistently. Hub repo_id dynamically determined from TSV data instead of hard-coded to 103.

### Quality of Life Improvements - Session 2025-10-17

**[QOL-01]: Optimize tree scanning with md5 caching** ✅
- **Status**: COMPLETED
- **Description**: Implemented intelligent MD5-based caching to skip full processing when repository tree unchanged. Computes MD5 hash of Cargo.toml file list and validates cache before processing. When tree hasn't changed, skips all 5 processing phases and returns cached data instantly.
- **Commit**: 645337c (feat: implement MD5 tree caching optimization (QOL-01))
- **Scope**: blade.py (compute_tree_md5, save_tree_metadata, load_tree_metadata, should_use_cached_data, generate_data_cache), benchmark_qol01.py (new)
- **Verification**: Benchmark shows 37x speedup (62.8s → 1.7s) when using cache. Full processing: 63.71s. Cached runs: 1.72s and 1.74s. Cache auto-expires after 24 hours. Metadata stored in ~/.cache/snek/blade/tree_metadata.json.
